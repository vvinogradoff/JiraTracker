<UserControl x:Class="UpworkJiraTracker.View.TimeLogControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:UpworkJiraTracker.ViewModel"
             xmlns:converters="clr-namespace:UpworkJiraTracker.XAML.Converter"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="600"
             d:DataContext="{d:DesignInstance Type=vm:TimeLogViewModel, IsDesignTimeCreatable=False}">

    <UserControl.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <!-- Header text style -->
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="Margin" Value="0,0,8,4"/>
        </Style>

        <!-- Column header style -->
        <Style x:Key="ColumnHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#666666"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="2"/>
        </Style>

        <!-- Cell text style -->
        <Style x:Key="CellTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="2"/>
        </Style>

        <!-- Ticket ID style -->
        <Style x:Key="TicketIdStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="#0052CC"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Refresh button -->
        <Button Grid.Row="0"
                Content="Refresh"
                Command="{Binding RefreshCommand}"
                Style="{StaticResource PrimaryButtonStyle}"
                HorizontalAlignment="Right"
                Margin="0,0,0,8"
                Padding="12,4"/>

        <!-- Time log data -->
        <ScrollViewer Grid.Row="1"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled">
            <ItemsControl ItemsSource="{Binding Weeks}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Margin="0,0,0,16"
                                BorderBrush="#E0E0E0"
                                BorderThickness="0,0,0,1"
                                Padding="0,0,0,12">
                            <StackPanel>
                                <!-- Week header -->
                                <TextBlock Text="{Binding WeekLabel}"
                                          Style="{StaticResource HeaderTextStyle}"
                                          Margin="0,0,0,8"/>

                                <!-- Column headers -->
                                <Grid Margin="0,0,0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Grid.Column="0" Text="Ticket" Style="{StaticResource ColumnHeaderStyle}" HorizontalAlignment="Left" Margin="2"/>
                                    <TextBlock Grid.Column="1" Text="Mon" Style="{StaticResource ColumnHeaderStyle}"/>
                                    <TextBlock Grid.Column="2" Text="Tue" Style="{StaticResource ColumnHeaderStyle}"/>
                                    <TextBlock Grid.Column="3" Text="Wed" Style="{StaticResource ColumnHeaderStyle}"/>
                                    <TextBlock Grid.Column="4" Text="Thu" Style="{StaticResource ColumnHeaderStyle}"/>
                                    <TextBlock Grid.Column="5" Text="Fri" Style="{StaticResource ColumnHeaderStyle}"/>
                                    <TextBlock Grid.Column="6" Text="Sat" Style="{StaticResource ColumnHeaderStyle}"/>
                                    <TextBlock Grid.Column="7" Text="Sun" Style="{StaticResource ColumnHeaderStyle}"/>
                                </Grid>

                                <!-- Entries for this week -->
                                <ItemsControl ItemsSource="{Binding Entries}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Margin="0,0,0,8">
                                                <!-- Entry row -->
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="80"/>
                                                        <ColumnDefinition Width="40"/>
                                                        <ColumnDefinition Width="40"/>
                                                        <ColumnDefinition Width="40"/>
                                                        <ColumnDefinition Width="40"/>
                                                        <ColumnDefinition Width="40"/>
                                                        <ColumnDefinition Width="40"/>
                                                        <ColumnDefinition Width="40"/>
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Column="0" Text="{Binding TicketId}" Style="{StaticResource TicketIdStyle}" HorizontalAlignment="Left"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding Monday, StringFormat={}{0:0.##}}" Style="{StaticResource CellTextStyle}"/>
                                                    <TextBlock Grid.Column="2" Text="{Binding Tuesday, StringFormat={}{0:0.##}}" Style="{StaticResource CellTextStyle}"/>
                                                    <TextBlock Grid.Column="3" Text="{Binding Wednesday, StringFormat={}{0:0.##}}" Style="{StaticResource CellTextStyle}"/>
                                                    <TextBlock Grid.Column="4" Text="{Binding Thursday, StringFormat={}{0:0.##}}" Style="{StaticResource CellTextStyle}"/>
                                                    <TextBlock Grid.Column="5" Text="{Binding Friday, StringFormat={}{0:0.##}}" Style="{StaticResource CellTextStyle}"/>
                                                    <TextBlock Grid.Column="6" Text="{Binding Saturday, StringFormat={}{0:0.##}}" Style="{StaticResource CellTextStyle}"/>
                                                    <TextBlock Grid.Column="7" Text="{Binding Sunday, StringFormat={}{0:0.##}}" Style="{StaticResource CellTextStyle}"/>
                                                </Grid>

                                                <!-- Summary as hint text below -->
                                                <TextBlock Text="{Binding Summary}"
                                                          Style="{StaticResource StyleSettingsHint}"
                                                          Margin="2,2,0,0"
                                                          TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- Loading overlay -->
        <Border Grid.Row="1"
                Background="#F0FFFFFF"
                Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">
            <TextBlock Text="Loading time log..."
                       FontSize="12"
                       Foreground="#666666"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"/>
        </Border>
    </Grid>
</UserControl>
